<div class="carrito-container">
    <div class="carrito-header">
        <h1>Mi Carrito</h1>
        <p class="subtitle">{{cartItems.length}} producto(s) en tu carrito</p>
    </div>

    @if(cartItems.length > 0) {
        <div class="carrito-content">
            <div class="carrito-items">
                @for(item of cartItems; track item.id) {
                    <div class="cart-item">
                        <div class="item-image">
                            <div class="image-placeholder">
                                <svg viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                    <polyline points="21 15 16 10 5 21"></polyline>
                                </svg>
                            </div>
                        </div>
                        <div class="item-info">
                            <h3>{{item.nombre}}</h3>
                            <p class="item-meta">{{item.categoria}}<span *ngIf="item.peso"> • {{item.peso}}</span></p>
                            <p class="item-price-mobile">S/ {{item.precio.toFixed(2)}}</p>
                        </div>
                        <div class="item-quantity">
                            <button class="qty-btn" (click)="updateQuantity(item, -1)">
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                            </button>
                            <span class="qty-value">{{item.cantidad}}</span>
                            <button class="qty-btn" (click)="updateQuantity(item, 1)">
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"></line>
                                    <line x1="5" y1="12" x2="19" y2="12"></line>
                                </svg>
                            </button>
                        </div>
                        <div class="item-price">
                            <span class="price">S/ {{(item.precio * item.cantidad).toFixed(2)}}</span>
                        </div>
                        <button class="item-remove" (click)="removeItem(item)">
                            <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                            </svg>
                        </button>
                    </div>
                }

                <div class="cart-actions-mobile">
                    <button class="btn btn-outline" (click)="clearCart()">Vaciar Carrito</button>
                    <a routerLink="/cliente/productos" class="btn btn-outline">Seguir Comprando</a>
                </div>
            </div>

            <div class="carrito-summary">
                <div class="summary-card">
                    <h2>Resumen del Pedido</h2>
                    
                    <div class="summary-items">
                        <div class="summary-row">
                            <span>Subtotal</span>
                            <span>S/ {{getSubtotal().toFixed(2)}}</span>
                        </div>
                        <div class="summary-row">
                            <span>Envío</span>
                            <span>S/ {{getEnvio().toFixed(2)}}</span>
                        </div>
                        <div class="summary-divider"></div>
                        <div class="summary-row total">
                            <span>Total</span>
                            <span>S/ {{getTotal().toFixed(2)}}</span>
                        </div>
                    </div>

                    <button class="btn btn-primary full-width" (click)="proceedToCheckout()">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                            <line x1="1" y1="10" x2="23" y2="10"></line>
                        </svg>
                        Proceder al Pago
                    </button>

                    <a routerLink="/cliente/productos" class="btn btn-outline full-width">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        Seguir Comprando
                    </a>

                    <div class="shipping-info">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="3" width="15" height="13"></rect>
                            <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                            <circle cx="5.5" cy="18.5" r="2.5"></circle>
                            <circle cx="18.5" cy="18.5" r="2.5"></circle>
                        </svg>
                        <p>Envío gratuito en pedidos mayores a S/ 100.00</p>
                    </div>
                </div>
            </div>
        </div>
    } @else {
        <div class="empty-cart">
            <svg viewBox="0 0 24 24" width="80" height="80" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path d="M1 1h4l2.68 12.39a2 2 0 0 0 2 1.61h7.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <h2>Tu carrito está vacío</h2>
            <p>Agrega productos para comenzar tu compra</p>
            <a routerLink="/cliente/productos" class="btn btn-primary">
                <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 12.39a2 2 0 0 0 2 1.61h7.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                Ir a Productos
            </a>
        </div>
    }
</div>

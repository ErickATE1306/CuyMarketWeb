<div class="shipping-calculator">
  <h3 class="calculator-title">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <rect x="1" y="3" width="15" height="13"></rect>
      <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
      <circle cx="5.5" cy="18.5" r="2.5"></circle>
      <circle cx="18.5" cy="18.5" r="2.5"></circle>
    </svg>
    Calcular envío
  </h3>

  <form (ngSubmit)="calculate()" class="calculator-form">
    <div class="form-group">
      <label for="district">Distrito de entrega</label>
      <select 
        id="district" 
        [(ngModel)]="selectedDistrict" 
        name="district" 
        required
        class="form-select"
      >
        <option value="">Selecciona tu distrito</option>
        @for (district of districts; track district.name) {
          <option [value]="district.name">
            {{ district.name }} - {{ getZoneLabel(district.zone) }}
          </option>
        }
      </select>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="weight">Peso (kg)</label>
        <input 
          type="number" 
          id="weight" 
          [(ngModel)]="weight" 
          name="weight" 
          min="1" 
          max="50" 
          step="0.5"
          class="form-input"
        >
      </div>

      <div class="form-group">
        <label for="quantity">Cantidad</label>
        <input 
          type="number" 
          id="quantity" 
          [(ngModel)]="quantity" 
          name="quantity" 
          min="1" 
          max="100"
          class="form-input"
        >
      </div>
    </div>

    <div class="calculator-actions">
      <button type="submit" class="btn-calculate" [disabled]="!selectedDistrict">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
        </svg>
        Calcular
      </button>
      @if (showResult) {
        <button type="button" class="btn-reset" (click)="reset()">
          Limpiar
        </button>
      }
    </div>
  </form>

  @if (showResult && result) {
    <div class="shipping-result">
      <div class="result-header">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <h4>Resultado del envío</h4>
      </div>

      <div class="result-details">
        <div class="detail-row">
          <span class="detail-label">Distrito:</span>
          <span class="detail-value">{{ result.district }}</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Zona:</span>
          <span 
            class="zone-badge" 
            [style.background-color]="getZoneColor(result.zone)"
          >
            {{ getZoneLabel(result.zone) }}
          </span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Tiempo de entrega:</span>
          <span class="detail-value">{{ result.deliveryDays }}</span>
        </div>
        <div class="detail-row price-row">
          <span class="detail-label">Costo de envío:</span>
          <span class="price-value">S/ {{ result.price.toFixed(2) }}</span>
        </div>
      </div>

      <div class="result-info">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <span>El tiempo de entrega es estimado y puede variar</span>
      </div>
    </div>
  }
</div>
